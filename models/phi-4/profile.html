<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Phi-4 mini — D3D12 driver version 32.0.15.9144</title>
<style>
:root {
  --bg: #1a1b26; --bg2: #1f2335; --bg3: #292e42; --fg: #c0caf5;
  --fg2: #a9b1d6; --fg3: #565f89; --blue: #7aa2f7; --purple: #bb9af7;
  --green: #9ece6a; --orange: #ff9e64; --red: #f7768e; --cyan: #7dcfff;
  --yellow: #e0af68; --teal: #73daca;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family:'Segoe UI',system-ui,sans-serif; background:var(--bg); color:var(--fg); font-size:13px; }
header { background:var(--bg2); padding:10px 16px; border-bottom:1px solid var(--bg3);
         display:flex; align-items:center; gap:16px; }
header h1 { font-size:15px; color:var(--purple); font-weight:600; }
header .chip { background:var(--bg3); padding:2px 8px; border-radius:4px; font-size:11px; color:var(--fg2); }
#controls { background:var(--bg2); padding:6px 16px; border-bottom:1px solid var(--bg3);
            display:flex; gap:8px; align-items:center; font-size:12px; }
#controls button { background:var(--bg3); color:var(--fg); border:none; padding:3px 10px;
                   border-radius:3px; cursor:pointer; font-size:11px; }
#controls button:hover { background:#3b4261; }
#controls .range { color:var(--fg3); margin-left:auto; }
#timeline-wrap { position:relative; overflow:hidden; cursor:grab; }
#timeline-wrap.dragging { cursor:grabbing; }
canvas { display:block; }
#tooltip { position:fixed; background:var(--bg3); color:var(--fg); padding:6px 10px;
           border-radius:4px; font-size:11px; pointer-events:none; display:none;
           border:1px solid #3b4261; z-index:100; line-height:1.5;
           box-shadow:0 2px 8px rgba(0,0,0,.5); max-width:360px; }
#tooltip b { color:var(--blue); }
#tooltip .dim { color:var(--fg3); }
#summary { padding:16px; display:flex; gap:16px; flex-wrap:wrap; }
.panel { background:var(--bg2); border:1px solid var(--bg3); border-radius:6px;
         padding:12px; min-width:280px; flex:1; }
.panel h2 { font-size:13px; color:var(--blue); margin-bottom:8px; }
.panel table { width:100%; border-collapse:collapse; font-size:11px; }
.panel th { text-align:left; padding:3px 6px; color:var(--fg3); border-bottom:1px solid var(--bg3); }
.panel td { padding:3px 6px; border-bottom:1px solid var(--bg); }
.panel td.r { text-align:right; font-variant-numeric:tabular-nums; }
.bar { height:4px; border-radius:2px; margin-top:1px; }
.step-cards { display:flex; gap:8px; flex-wrap:wrap; padding:8px 16px; }
.step-card { background:var(--bg2); border:1px solid var(--bg3); border-radius:6px;
             padding:8px 12px; min-width:90px; text-align:center; }
.step-card .label { font-size:10px; color:var(--fg3); }
.step-card .value { font-size:16px; font-weight:600; color:var(--green); }
.step-card .unit { font-size:10px; color:var(--fg3); }
</style>
</head>
<body>
<header>
  <h1>Phi-4 mini — D3D12 driver version 32.0.15.9144</h1>
  <span class="chip" id="gpu-chip"></span>
  <span class="chip" id="backend-chip"></span>
</header>
<div class="step-cards" id="step-cards"></div>
<div id="controls">
  <button onclick="resetZoom()">Reset</button>
  <button onclick="zoomIn()">+ Zoom</button>
  <button onclick="zoomOut()">- Zoom</button>
  <span class="range" id="range-label"></span>
</div>
<div id="timeline-wrap"><canvas id="c"></canvas></div>
<div id="tooltip"></div>
<div id="summary">
  <div class="panel"><h2>CPU Ops</h2><table id="cpu-tbl"><thead><tr>
    <th>Op</th><th>Total</th><th>#</th><th>Avg</th><th>%</th><th></th>
  </tr></thead><tbody></tbody></table></div>
  <div class="panel"><h2>GPU Dispatches</h2><table id="gpu-tbl"><thead><tr>
    <th>Op</th><th>Total</th><th>#</th><th>Avg</th><th>%</th><th></th>
  </tr></thead><tbody></tbody></table></div>
  <div class="panel" id="mem-panel"><h2>Memory</h2><div id="mem-info"></div></div>
</div>
<script>
const C=document.getElementById('c'), X=C.getContext('2d'),
      W=document.getElementById('timeline-wrap'),
      TT=document.getElementById('tooltip');
const cpu=/*CPU*/[{"name": "embed", "scope": "prefill", "start_us": 18.4, "dur_us": 39.6, "gpu": false}, {"name": "sampling", "scope": "decode_0", "start_us": 2226146.8, "dur_us": 96.2, "gpu": false}, {"name": "sampling", "scope": "decode_1", "start_us": 2235118.4, "dur_us": 25.7, "gpu": false}, {"name": "sampling", "scope": "decode_2", "start_us": 2244178.1, "dur_us": 29.8, "gpu": false}, {"name": "sampling", "scope": "decode_3", "start_us": 2253235.8, "dur_us": 32.4, "gpu": false}, {"name": "sampling", "scope": "decode_4", "start_us": 2262374.5, "dur_us": 33.1, "gpu": false}, {"name": "sampling", "scope": "decode_5", "start_us": 2271405.9, "dur_us": 33.0, "gpu": false}, {"name": "sampling", "scope": "decode_6", "start_us": 2280233.3, "dur_us": 39.6, "gpu": false}, {"name": "sampling", "scope": "decode_7", "start_us": 2289221.6, "dur_us": 25.6, "gpu": false}, {"name": "sampling", "scope": "decode_8", "start_us": 2298518.3, "dur_us": 31.0, "gpu": false}, {"name": "sampling", "scope": "decode_9", "start_us": 2307796.5, "dur_us": 45.1, "gpu": false}];
const gpu=/*GPU*/[{"name": "L0/norm1", "start_us": 24526.2, "dur_us": 702228.1}, {"name": "L0/qkv", "start_us": 726830.4, "dur_us": 908.0}, {"name": "L0/rope_q", "start_us": 727803.5, "dur_us": 296.1}, {"name": "L0/rope_kv", "start_us": 728112.1, "dur_us": 155.2}, {"name": "L0/attn", "start_us": 728306.8, "dur_us": 134.0}, {"name": "L0/o_proj", "start_us": 728456.3, "dur_us": 69.7}, {"name": "L0/res1", "start_us": 728533.9, "dur_us": 93.2}, {"name": "L0/norm2", "start_us": 728637.0, "dur_us": 83.3}, {"name": "L0/mlp", "start_us": 728747.3, "dur_us": 75.6}, {"name": "L0/mlp", "start_us": 728840.0, "dur_us": 70.1}, {"name": "L0/mlp", "start_us": 728918.8, "dur_us": 594.0}, {"name": "L0/res2", "start_us": 729525.1, "dur_us": 85.1}, {"name": "L1/norm1", "start_us": 765826.2, "dur_us": 10243.3}, {"name": "L1/qkv", "start_us": 776118.7, "dur_us": 3870.6}, {"name": "L1/rope_q", "start_us": 780062.3, "dur_us": 253.1}, {"name": "L1/rope_kv", "start_us": 780330.2, "dur_us": 139.4}, {"name": "L1/attn", "start_us": 780508.4, "dur_us": 151.5}, {"name": "L1/o_proj", "start_us": 780671.1, "dur_us": 56.6}, {"name": "L1/res1", "start_us": 780733.9, "dur_us": 43.9}, {"name": "L1/norm2", "start_us": 780784.3, "dur_us": 53.1}, {"name": "L1/mlp", "start_us": 780852.1, "dur_us": 579.3}, {"name": "L1/mlp", "start_us": 781468.2, "dur_us": 223.8}, {"name": "L1/mlp", "start_us": 781703.8, "dur_us": 65.7}, {"name": "L1/res2", "start_us": 781776.4, "dur_us": 42.6}, {"name": "L2/norm1", "start_us": 807790.6, "dur_us": 11321.5}, {"name": "L2/qkv", "start_us": 819146.5, "dur_us": 3318.6}, {"name": "L2/rope_q", "start_us": 822516.9, "dur_us": 221.8}, {"name": "L2/rope_kv", "start_us": 822748.7, "dur_us": 124.3}, {"name": "L2/attn", "start_us": 822904.3, "dur_us": 86.3}, {"name": "L2/o_proj", "start_us": 823002.4, "dur_us": 81.4}, {"name": "L2/res1", "start_us": 823090.4, "dur_us": 49.7}, {"name": "L2/norm2", "start_us": 823146.8, "dur_us": 53.2}, {"name": "L2/mlp", "start_us": 823213.9, "dur_us": 54.8}, {"name": "L2/mlp", "start_us": 823278.9, "dur_us": 76.4}, {"name": "L2/mlp", "start_us": 823363.7, "dur_us": 59.4}, {"name": "L2/res2", "start_us": 823428.4, "dur_us": 39.3}, {"name": "L3/norm1", "start_us": 848383.9, "dur_us": 10082.0}, {"name": "L3/qkv", "start_us": 858486.9, "dur_us": 3410.0}, {"name": "L3/rope_q", "start_us": 861962.0, "dur_us": 267.2}, {"name": "L3/rope_kv", "start_us": 862243.7, "dur_us": 137.1}, {"name": "L3/attn", "start_us": 862417.3, "dur_us": 103.9}, {"name": "L3/o_proj", "start_us": 862538.1, "dur_us": 98.0}, {"name": "L3/res1", "start_us": 862647.2, "dur_us": 74.9}, {"name": "L3/norm2", "start_us": 862733.3, "dur_us": 65.9}, {"name": "L3/mlp", "start_us": 862810.4, "dur_us": 54.1}, {"name": "L3/mlp", "start_us": 862871.4, "dur_us": 43.4}, {"name": "L3/mlp", "start_us": 862920.7, "dur_us": 46.5}, {"name": "L3/res2", "start_us": 862971.6, "dur_us": 36.7}, {"name": "L4/norm1", "start_us": 888708.0, "dur_us": 10587.6}, {"name": "L4/qkv", "start_us": 899332.9, "dur_us": 3166.4}, {"name": "L4/rope_q", "start_us": 902555.7, "dur_us": 202.6}, {"name": "L4/rope_kv", "start_us": 902770.3, "dur_us": 123.6}, {"name": "L4/attn", "start_us": 902926.5, "dur_us": 98.9}, {"name": "L4/o_proj", "start_us": 903040.5, "dur_us": 93.9}, {"name": "L4/res1", "start_us": 903143.3, "dur_us": 71.4}, {"name": "L4/norm2", "start_us": 903224.8, "dur_us": 88.2}, {"name": "L4/mlp", "start_us": 903330.4, "dur_us": 91.8}, {"name": "L4/mlp", "start_us": 903434.4, "dur_us": 79.4}, {"name": "L4/mlp", "start_us": 903525.3, "dur_us": 85.7}, {"name": "L4/res2", "start_us": 903619.2, "dur_us": 66.2}, {"name": "L5/norm1", "start_us": 930513.9, "dur_us": 9945.8}, {"name": "L5/qkv", "start_us": 940485.8, "dur_us": 3573.0}, {"name": "L5/rope_q", "start_us": 944123.4, "dur_us": 272.0}, {"name": "L5/rope_kv", "start_us": 944409.0, "dur_us": 138.0}, {"name": "L5/attn", "start_us": 944580.4, "dur_us": 98.6}, {"name": "L5/o_proj", "start_us": 944688.7, "dur_us": 54.0}, {"name": "L5/res1", "start_us": 944748.2, "dur_us": 42.3}, {"name": "L5/norm2", "start_us": 944796.7, "dur_us": 50.6}, {"name": "L5/mlp", "start_us": 944858.8, "dur_us": 54.1}, {"name": "L5/mlp", "start_us": 944919.8, "dur_us": 46.6}, {"name": "L5/mlp", "start_us": 944972.3, "dur_us": 47.0}, {"name": "L5/res2", "start_us": 945024.1, "dur_us": 36.2}, {"name": "L6/norm1", "start_us": 971041.5, "dur_us": 11201.0}, {"name": "L6/qkv", "start_us": 982300.8, "dur_us": 3398.9}, {"name": "L6/rope_q", "start_us": 985789.9, "dur_us": 315.4}, {"name": "L6/rope_kv", "start_us": 986120.5, "dur_us": 171.7}, {"name": "L6/attn", "start_us": 986332.6, "dur_us": 123.2}, {"name": "L6/o_proj", "start_us": 986476.7, "dur_us": 111.7}, {"name": "L6/res1", "start_us": 986597.8, "dur_us": 81.3}, {"name": "L6/norm2", "start_us": 986691.6, "dur_us": 98.1}, {"name": "L6/mlp", "start_us": 986806.1, "dur_us": 73.9}, {"name": "L6/mlp", "start_us": 986888.1, "dur_us": 50.0}, {"name": "L6/mlp", "start_us": 986944.9, "dur_us": 56.9}, {"name": "L6/res2", "start_us": 987006.2, "dur_us": 38.4}, {"name": "L7/norm1", "start_us": 1013908.3, "dur_us": 10858.6}, {"name": "L7/qkv", "start_us": 1024808.3, "dur_us": 3130.4}, {"name": "L7/rope_q", "start_us": 1027993.0, "dur_us": 212.2}, {"name": "L7/rope_kv", "start_us": 1028216.5, "dur_us": 122.9}, {"name": "L7/attn", "start_us": 1028371.1, "dur_us": 87.7}, {"name": "L7/o_proj", "start_us": 1028472.0, "dur_us": 80.4}, {"name": "L7/res1", "start_us": 1028559.7, "dur_us": 50.3}, {"name": "L7/norm2", "start_us": 1028616.8, "dur_us": 56.8}, {"name": "L7/mlp", "start_us": 1028689.1, "dur_us": 65.0}, {"name": "L7/mlp", "start_us": 1028766.2, "dur_us": 79.1}, {"name": "L7/mlp", "start_us": 1028853.1, "dur_us": 54.2}, {"name": "L7/res2", "start_us": 1028912.3, "dur_us": 38.4}, {"name": "L8/norm1", "start_us": 1054662.3, "dur_us": 10966.3}, {"name": "L8/qkv", "start_us": 1065665.1, "dur_us": 3150.4}, {"name": "L8/rope_q", "start_us": 1068863.6, "dur_us": 188.4}, {"name": "L8/rope_kv", "start_us": 1069062.4, "dur_us": 91.5}, {"name": "L8/attn", "start_us": 1069181.5, "dur_us": 68.7}, {"name": "L8/o_proj", "start_us": 1069260.8, "dur_us": 58.3}, {"name": "L8/res1", "start_us": 1069325.0, "dur_us": 45.5}, {"name": "L8/norm2", "start_us": 1069377.3, "dur_us": 54.7}, {"name": "L8/mlp", "start_us": 1069445.4, "dur_us": 56.8}, {"name": "L8/mlp", "start_us": 1069510.1, "dur_us": 50.7}, {"name": "L8/mlp", "start_us": 1069567.5, "dur_us": 52.8}, {"name": "L8/res2", "start_us": 1069624.9, "dur_us": 38.1}, {"name": "L9/norm1", "start_us": 1095709.5, "dur_us": 10660.4}, {"name": "L9/qkv", "start_us": 1106404.7, "dur_us": 3587.3}, {"name": "L9/rope_q", "start_us": 1110036.5, "dur_us": 157.6}, {"name": "L9/rope_kv", "start_us": 1110203.7, "dur_us": 110.8}, {"name": "L9/attn", "start_us": 1110344.2, "dur_us": 80.0}, {"name": "L9/o_proj", "start_us": 1110434.3, "dur_us": 79.4}, {"name": "L9/res1", "start_us": 1110520.5, "dur_us": 49.2}, {"name": "L9/norm2", "start_us": 1110576.5, "dur_us": 55.1}, {"name": "L9/mlp", "start_us": 1110645.7, "dur_us": 65.0}, {"name": "L9/mlp", "start_us": 1110725.0, "dur_us": 74.6}, {"name": "L9/mlp", "start_us": 1110807.2, "dur_us": 57.4}, {"name": "L9/res2", "start_us": 1110870.2, "dur_us": 38.7}, {"name": "L10/norm1", "start_us": 1136147.7, "dur_us": 11800.6}, {"name": "L10/qkv", "start_us": 1147970.4, "dur_us": 3030.1}, {"name": "L10/rope_q", "start_us": 1151066.6, "dur_us": 263.7}, {"name": "L10/rope_kv", "start_us": 1151344.6, "dur_us": 138.4}, {"name": "L10/attn", "start_us": 1151517.4, "dur_us": 105.9}, {"name": "L10/o_proj", "start_us": 1151635.6, "dur_us": 52.0}, {"name": "L10/res1", "start_us": 1151692.8, "dur_us": 41.4}, {"name": "L10/norm2", "start_us": 1151740.5, "dur_us": 50.2}, {"name": "L10/mlp", "start_us": 1151803.4, "dur_us": 53.5}, {"name": "L10/mlp", "start_us": 1151866.1, "dur_us": 49.3}, {"name": "L10/mlp", "start_us": 1151921.6, "dur_us": 53.6}, {"name": "L10/res2", "start_us": 1151980.3, "dur_us": 38.3}, {"name": "L11/norm1", "start_us": 1178871.0, "dur_us": 10287.7}, {"name": "L11/qkv", "start_us": 1189201.5, "dur_us": 3687.8}, {"name": "L11/rope_q", "start_us": 1192933.5, "dur_us": 171.6}, {"name": "L11/rope_kv", "start_us": 1193113.5, "dur_us": 95.0}, {"name": "L11/attn", "start_us": 1193234.1, "dur_us": 91.1}, {"name": "L11/o_proj", "start_us": 1193336.8, "dur_us": 78.5}, {"name": "L11/res1", "start_us": 1193421.5, "dur_us": 45.5}, {"name": "L11/norm2", "start_us": 1193473.2, "dur_us": 52.9}, {"name": "L11/mlp", "start_us": 1193539.2, "dur_us": 55.0}, {"name": "L11/mlp", "start_us": 1193602.3, "dur_us": 70.7}, {"name": "L11/mlp", "start_us": 1193682.2, "dur_us": 60.3}, {"name": "L11/res2", "start_us": 1193747.9, "dur_us": 38.4}, {"name": "L12/norm1", "start_us": 1219660.5, "dur_us": 10836.5}, {"name": "L12/qkv", "start_us": 1230553.8, "dur_us": 3561.2}, {"name": "L12/rope_q", "start_us": 1234187.5, "dur_us": 303.0}, {"name": "L12/rope_kv", "start_us": 1234509.5, "dur_us": 164.8}, {"name": "L12/attn", "start_us": 1234705.9, "dur_us": 90.2}, {"name": "L12/o_proj", "start_us": 1234808.4, "dur_us": 82.9}, {"name": "L12/res1", "start_us": 1234898.2, "dur_us": 52.8}, {"name": "L12/norm2", "start_us": 1234957.8, "dur_us": 53.8}, {"name": "L12/mlp", "start_us": 1235025.1, "dur_us": 58.4}, {"name": "L12/mlp", "start_us": 1235093.4, "dur_us": 75.5}, {"name": "L12/mlp", "start_us": 1235176.6, "dur_us": 57.0}, {"name": "L12/res2", "start_us": 1235238.6, "dur_us": 37.7}, {"name": "L13/norm1", "start_us": 1262502.4, "dur_us": 10485.8}, {"name": "L13/qkv", "start_us": 1273032.4, "dur_us": 3986.7}, {"name": "L13/rope_q", "start_us": 1277097.9, "dur_us": 325.8}, {"name": "L13/rope_kv", "start_us": 1277439.2, "dur_us": 171.3}, {"name": "L13/attn", "start_us": 1277656.2, "dur_us": 101.2}, {"name": "L13/o_proj", "start_us": 1277768.7, "dur_us": 83.1}, {"name": "L13/res1", "start_us": 1277859.4, "dur_us": 50.5}, {"name": "L13/norm2", "start_us": 1277917.3, "dur_us": 53.4}, {"name": "L13/mlp", "start_us": 1277985.1, "dur_us": 61.3}, {"name": "L13/mlp", "start_us": 1278056.4, "dur_us": 81.0}, {"name": "L13/mlp", "start_us": 1278145.4, "dur_us": 57.4}, {"name": "L13/res2", "start_us": 1278207.9, "dur_us": 40.9}, {"name": "L14/norm1", "start_us": 1303256.5, "dur_us": 10697.7}, {"name": "L14/qkv", "start_us": 1314000.8, "dur_us": 3166.7}, {"name": "L14/rope_q", "start_us": 1317232.0, "dur_us": 214.4}, {"name": "L14/rope_kv", "start_us": 1317460.4, "dur_us": 129.2}, {"name": "L14/attn", "start_us": 1317625.5, "dur_us": 109.7}, {"name": "L14/o_proj", "start_us": 1317747.8, "dur_us": 54.9}, {"name": "L14/res1", "start_us": 1317807.7, "dur_us": 42.3}, {"name": "L14/norm2", "start_us": 1317856.3, "dur_us": 50.7}, {"name": "L14/mlp", "start_us": 1317918.5, "dur_us": 53.8}, {"name": "L14/mlp", "start_us": 1317984.6, "dur_us": 51.3}, {"name": "L14/mlp", "start_us": 1318042.0, "dur_us": 59.3}, {"name": "L14/res2", "start_us": 1318106.1, "dur_us": 40.8}, {"name": "L15/norm1", "start_us": 1343832.6, "dur_us": 11022.9}, {"name": "L15/qkv", "start_us": 1354878.3, "dur_us": 3508.7}, {"name": "L15/rope_q", "start_us": 1358427.2, "dur_us": 146.1}, {"name": "L15/rope_kv", "start_us": 1358581.6, "dur_us": 79.2}, {"name": "L15/attn", "start_us": 1358686.3, "dur_us": 67.1}, {"name": "L15/o_proj", "start_us": 1358765.2, "dur_us": 83.4}, {"name": "L15/res1", "start_us": 1358855.4, "dur_us": 49.1}, {"name": "L15/norm2", "start_us": 1358911.4, "dur_us": 49.9}, {"name": "L15/mlp", "start_us": 1358973.8, "dur_us": 51.2}, {"name": "L15/mlp", "start_us": 1359032.2, "dur_us": 67.4}, {"name": "L15/mlp", "start_us": 1359109.0, "dur_us": 62.4}, {"name": "L15/res2", "start_us": 1359176.5, "dur_us": 39.2}, {"name": "L16/norm1", "start_us": 1384111.8, "dur_us": 10716.4}, {"name": "L16/qkv", "start_us": 1394866.7, "dur_us": 3549.1}, {"name": "L16/rope_q", "start_us": 1398479.2, "dur_us": 202.0}, {"name": "L16/rope_kv", "start_us": 1398688.3, "dur_us": 96.7}, {"name": "L16/attn", "start_us": 1398810.8, "dur_us": 76.3}, {"name": "L16/o_proj", "start_us": 1398897.2, "dur_us": 74.3}, {"name": "L16/res1", "start_us": 1398977.7, "dur_us": 43.5}, {"name": "L16/norm2", "start_us": 1399027.7, "dur_us": 49.9}, {"name": "L16/mlp", "start_us": 1399089.8, "dur_us": 51.3}, {"name": "L16/mlp", "start_us": 1399149.0, "dur_us": 67.8}, {"name": "L16/mlp", "start_us": 1399226.1, "dur_us": 73.3}, {"name": "L16/res2", "start_us": 1399304.5, "dur_us": 39.0}, {"name": "L17/norm1", "start_us": 1426196.0, "dur_us": 10064.3}, {"name": "L17/qkv", "start_us": 1436301.9, "dur_us": 4104.9}, {"name": "L17/rope_q", "start_us": 1440454.9, "dur_us": 179.7}, {"name": "L17/rope_kv", "start_us": 1440643.0, "dur_us": 89.9}, {"name": "L17/attn", "start_us": 1440760.5, "dur_us": 69.6}, {"name": "L17/o_proj", "start_us": 1440840.4, "dur_us": 64.2}, {"name": "L17/res1", "start_us": 1440910.3, "dur_us": 46.9}, {"name": "L17/norm2", "start_us": 1440963.6, "dur_us": 52.9}, {"name": "L17/mlp", "start_us": 1441041.7, "dur_us": 55.2}, {"name": "L17/mlp", "start_us": 1441104.9, "dur_us": 51.5}, {"name": "L17/mlp", "start_us": 1441162.8, "dur_us": 53.3}, {"name": "L17/res2", "start_us": 1441220.5, "dur_us": 38.3}, {"name": "L18/norm1", "start_us": 1466784.6, "dur_us": 11365.3}, {"name": "L18/qkv", "start_us": 1478180.3, "dur_us": 3163.8}, {"name": "L18/rope_q", "start_us": 1481413.4, "dur_us": 272.7}, {"name": "L18/rope_kv", "start_us": 1481695.1, "dur_us": 91.1}, {"name": "L18/attn", "start_us": 1481813.1, "dur_us": 66.7}, {"name": "L18/o_proj", "start_us": 1481889.7, "dur_us": 56.3}, {"name": "L18/res1", "start_us": 1481951.7, "dur_us": 44.2}, {"name": "L18/norm2", "start_us": 1482002.4, "dur_us": 52.4}, {"name": "L18/mlp", "start_us": 1482067.1, "dur_us": 54.4}, {"name": "L18/mlp", "start_us": 1482128.5, "dur_us": 48.8}, {"name": "L18/mlp", "start_us": 1482183.6, "dur_us": 50.2}, {"name": "L18/res2", "start_us": 1482238.2, "dur_us": 37.2}, {"name": "L19/norm1", "start_us": 1508215.7, "dur_us": 9995.3}, {"name": "L19/qkv", "start_us": 1518262.1, "dur_us": 3567.2}, {"name": "L19/rope_q", "start_us": 1521874.2, "dur_us": 218.7}, {"name": "L19/rope_kv", "start_us": 1522105.5, "dur_us": 110.7}, {"name": "L19/attn", "start_us": 1522246.8, "dur_us": 68.6}, {"name": "L19/o_proj", "start_us": 1522328.0, "dur_us": 59.8}, {"name": "L19/res1", "start_us": 1522393.6, "dur_us": 53.9}, {"name": "L19/norm2", "start_us": 1522453.8, "dur_us": 53.5}, {"name": "L19/mlp", "start_us": 1522520.4, "dur_us": 59.5}, {"name": "L19/mlp", "start_us": 1522592.8, "dur_us": 53.3}, {"name": "L19/mlp", "start_us": 1522652.3, "dur_us": 52.3}, {"name": "L19/res2", "start_us": 1522709.2, "dur_us": 38.5}, {"name": "L20/norm1", "start_us": 1548747.8, "dur_us": 10689.7}, {"name": "L20/qkv", "start_us": 1559481.9, "dur_us": 3584.1}, {"name": "L20/rope_q", "start_us": 1563136.2, "dur_us": 324.5}, {"name": "L20/rope_kv", "start_us": 1563476.6, "dur_us": 169.3}, {"name": "L20/attn", "start_us": 1563684.4, "dur_us": 72.6}, {"name": "L20/o_proj", "start_us": 1563766.9, "dur_us": 57.2}, {"name": "L20/res1", "start_us": 1563829.5, "dur_us": 57.6}, {"name": "L20/norm2", "start_us": 1563894.4, "dur_us": 56.8}, {"name": "L20/mlp", "start_us": 1563963.4, "dur_us": 56.5}, {"name": "L20/mlp", "start_us": 1564027.5, "dur_us": 52.7}, {"name": "L20/mlp", "start_us": 1564086.3, "dur_us": 52.2}, {"name": "L20/res2", "start_us": 1564142.9, "dur_us": 37.9}, {"name": "L21/norm1", "start_us": 1588975.8, "dur_us": 10041.0}, {"name": "L21/qkv", "start_us": 1599057.0, "dur_us": 3558.6}, {"name": "L21/rope_q", "start_us": 1602682.1, "dur_us": 280.2}, {"name": "L21/rope_kv", "start_us": 1602979.7, "dur_us": 171.2}, {"name": "L21/attn", "start_us": 1603193.5, "dur_us": 130.3}, {"name": "L21/o_proj", "start_us": 1603345.3, "dur_us": 125.9}, {"name": "L21/res1", "start_us": 1603482.0, "dur_us": 79.5}, {"name": "L21/norm2", "start_us": 1603573.6, "dur_us": 99.6}, {"name": "L21/mlp", "start_us": 1603697.3, "dur_us": 81.2}, {"name": "L21/mlp", "start_us": 1603786.8, "dur_us": 52.1}, {"name": "L21/mlp", "start_us": 1603845.6, "dur_us": 47.6}, {"name": "L21/res2", "start_us": 1603897.7, "dur_us": 36.8}, {"name": "L22/norm1", "start_us": 1628934.6, "dur_us": 10563.5}, {"name": "L22/qkv", "start_us": 1639526.6, "dur_us": 3146.3}, {"name": "L22/rope_q", "start_us": 1642728.3, "dur_us": 322.9}, {"name": "L22/rope_kv", "start_us": 1643066.7, "dur_us": 169.0}, {"name": "L22/attn", "start_us": 1643280.1, "dur_us": 149.6}, {"name": "L22/o_proj", "start_us": 1643454.9, "dur_us": 135.9}, {"name": "L22/res1", "start_us": 1643601.9, "dur_us": 72.8}, {"name": "L22/norm2", "start_us": 1643681.8, "dur_us": 52.6}, {"name": "L22/mlp", "start_us": 1643747.2, "dur_us": 80.3}, {"name": "L22/mlp", "start_us": 1643837.8, "dur_us": 61.7}, {"name": "L22/mlp", "start_us": 1643907.0, "dur_us": 50.9}, {"name": "L22/res2", "start_us": 1643963.1, "dur_us": 38.5}, {"name": "L23/norm1", "start_us": 1669846.1, "dur_us": 9922.9}, {"name": "L23/qkv", "start_us": 1679807.4, "dur_us": 3526.0}, {"name": "L23/rope_q", "start_us": 1683372.9, "dur_us": 147.0}, {"name": "L23/rope_kv", "start_us": 1683527.9, "dur_us": 77.8}, {"name": "L23/attn", "start_us": 1683629.1, "dur_us": 73.0}, {"name": "L23/o_proj", "start_us": 1683714.3, "dur_us": 80.3}, {"name": "L23/res1", "start_us": 1683800.7, "dur_us": 47.8}, {"name": "L23/norm2", "start_us": 1683855.4, "dur_us": 51.9}, {"name": "L23/mlp", "start_us": 1683918.8, "dur_us": 54.9}, {"name": "L23/mlp", "start_us": 1683981.3, "dur_us": 80.0}, {"name": "L23/mlp", "start_us": 1684070.0, "dur_us": 58.3}, {"name": "L23/res2", "start_us": 1684133.3, "dur_us": 39.0}, {"name": "L24/norm1", "start_us": 1709707.0, "dur_us": 10211.9}, {"name": "L24/qkv", "start_us": 1719966.9, "dur_us": 3385.1}, {"name": "L24/rope_q", "start_us": 1723396.2, "dur_us": 164.4}, {"name": "L24/rope_kv", "start_us": 1723569.1, "dur_us": 89.4}, {"name": "L24/attn", "start_us": 1723684.4, "dur_us": 66.8}, {"name": "L24/o_proj", "start_us": 1723760.7, "dur_us": 555.3}, {"name": "L24/res1", "start_us": 1724326.8, "dur_us": 85.7}, {"name": "L24/norm2", "start_us": 1724422.1, "dur_us": 59.5}, {"name": "L24/mlp", "start_us": 1724495.7, "dur_us": 57.0}, {"name": "L24/mlp", "start_us": 1724560.9, "dur_us": 91.0}, {"name": "L24/mlp", "start_us": 1724659.1, "dur_us": 53.9}, {"name": "L24/res2", "start_us": 1724718.0, "dur_us": 41.4}, {"name": "L25/norm1", "start_us": 1750782.4, "dur_us": 11156.3}, {"name": "L25/qkv", "start_us": 1761971.4, "dur_us": 4031.9}, {"name": "L25/rope_q", "start_us": 1766051.4, "dur_us": 181.4}, {"name": "L25/rope_kv", "start_us": 1766241.6, "dur_us": 91.9}, {"name": "L25/attn", "start_us": 1766361.1, "dur_us": 71.0}, {"name": "L25/o_proj", "start_us": 1766442.0, "dur_us": 69.1}, {"name": "L25/res1", "start_us": 1766518.5, "dur_us": 77.2}, {"name": "L25/norm2", "start_us": 1766604.0, "dur_us": 61.8}, {"name": "L25/mlp", "start_us": 1766678.6, "dur_us": 58.6}, {"name": "L25/mlp", "start_us": 1766754.5, "dur_us": 69.8}, {"name": "L25/mlp", "start_us": 1766831.9, "dur_us": 71.0}, {"name": "L25/res2", "start_us": 1766908.4, "dur_us": 41.7}, {"name": "L26/norm1", "start_us": 1793179.2, "dur_us": 10544.2}, {"name": "L26/qkv", "start_us": 1803764.3, "dur_us": 3777.2}, {"name": "L26/rope_q", "start_us": 1807585.9, "dur_us": 154.4}, {"name": "L26/rope_kv", "start_us": 1807748.8, "dur_us": 84.8}, {"name": "L26/attn", "start_us": 1807859.6, "dur_us": 65.5}, {"name": "L26/o_proj", "start_us": 1807934.8, "dur_us": 58.5}, {"name": "L26/res1", "start_us": 1807998.5, "dur_us": 45.8}, {"name": "L26/norm2", "start_us": 1808050.7, "dur_us": 52.2}, {"name": "L26/mlp", "start_us": 1808115.1, "dur_us": 52.5}, {"name": "L26/mlp", "start_us": 1808174.4, "dur_us": 48.1}, {"name": "L26/mlp", "start_us": 1808229.0, "dur_us": 49.8}, {"name": "L26/res2", "start_us": 1808283.6, "dur_us": 42.8}, {"name": "L27/norm1", "start_us": 1835779.2, "dur_us": 11399.4}, {"name": "L27/qkv", "start_us": 1847220.1, "dur_us": 3547.0}, {"name": "L27/rope_q", "start_us": 1850839.7, "dur_us": 307.2}, {"name": "L27/rope_kv", "start_us": 1851162.0, "dur_us": 188.5}, {"name": "L27/attn", "start_us": 1851396.1, "dur_us": 140.9}, {"name": "L27/o_proj", "start_us": 1851556.4, "dur_us": 108.2}, {"name": "L27/res1", "start_us": 1851675.2, "dur_us": 114.0}, {"name": "L27/norm2", "start_us": 1851803.2, "dur_us": 70.0}, {"name": "L27/mlp", "start_us": 1851886.1, "dur_us": 73.9}, {"name": "L27/mlp", "start_us": 1851970.1, "dur_us": 63.7}, {"name": "L27/mlp", "start_us": 1852041.2, "dur_us": 51.5}, {"name": "L27/res2", "start_us": 1852097.7, "dur_us": 38.3}, {"name": "L28/norm1", "start_us": 1876375.2, "dur_us": 10128.9}, {"name": "L28/qkv", "start_us": 1886552.6, "dur_us": 3394.5}, {"name": "L28/rope_q", "start_us": 1889994.2, "dur_us": 179.8}, {"name": "L28/rope_kv", "start_us": 1890182.4, "dur_us": 91.0}, {"name": "L28/attn", "start_us": 1890300.5, "dur_us": 67.3}, {"name": "L28/o_proj", "start_us": 1890385.3, "dur_us": 61.5}, {"name": "L28/res1", "start_us": 1890452.4, "dur_us": 603.4}, {"name": "L28/norm2", "start_us": 1891072.9, "dur_us": 124.3}, {"name": "L28/mlp", "start_us": 1891214.5, "dur_us": 72.7}, {"name": "L28/mlp", "start_us": 1891296.5, "dur_us": 50.9}, {"name": "L28/mlp", "start_us": 1891354.7, "dur_us": 51.8}, {"name": "L28/res2", "start_us": 1891411.9, "dur_us": 41.4}, {"name": "L29/norm1", "start_us": 1918197.3, "dur_us": 11633.6}, {"name": "L29/qkv", "start_us": 1929862.1, "dur_us": 3368.1}, {"name": "L29/rope_q", "start_us": 1933275.8, "dur_us": 181.5}, {"name": "L29/rope_kv", "start_us": 1933465.6, "dur_us": 89.1}, {"name": "L29/attn", "start_us": 1933580.2, "dur_us": 73.4}, {"name": "L29/o_proj", "start_us": 1933665.5, "dur_us": 58.5}, {"name": "L29/res1", "start_us": 1933729.2, "dur_us": 46.4}, {"name": "L29/norm2", "start_us": 1933782.1, "dur_us": 51.3}, {"name": "L29/mlp", "start_us": 1933845.5, "dur_us": 54.0}, {"name": "L29/mlp", "start_us": 1933906.3, "dur_us": 45.9}, {"name": "L29/mlp", "start_us": 1933958.5, "dur_us": 51.6}, {"name": "L29/res2", "start_us": 1934014.3, "dur_us": 40.9}, {"name": "L30/norm1", "start_us": 1962129.0, "dur_us": 10967.1}, {"name": "L30/qkv", "start_us": 1973136.5, "dur_us": 3274.1}, {"name": "L30/rope_q", "start_us": 1976484.2, "dur_us": 266.0}, {"name": "L30/rope_kv", "start_us": 1976759.3, "dur_us": 97.8}, {"name": "L30/attn", "start_us": 1976885.0, "dur_us": 73.9}, {"name": "L30/o_proj", "start_us": 1976968.2, "dur_us": 61.7}, {"name": "L30/res1", "start_us": 1977036.1, "dur_us": 48.7}, {"name": "L30/norm2", "start_us": 1977091.2, "dur_us": 53.3}, {"name": "L30/mlp", "start_us": 1977156.8, "dur_us": 54.9}, {"name": "L30/mlp", "start_us": 1977218.4, "dur_us": 51.2}, {"name": "L30/mlp", "start_us": 1977276.0, "dur_us": 55.3}, {"name": "L30/res2", "start_us": 1977335.7, "dur_us": 41.3}, {"name": "L31/norm1", "start_us": 2003290.8, "dur_us": 10876.5}, {"name": "L31/qkv", "start_us": 2014222.1, "dur_us": 3931.3}, {"name": "L31/rope_q", "start_us": 2018203.2, "dur_us": 189.9}, {"name": "L31/rope_kv", "start_us": 2018401.6, "dur_us": 97.5}, {"name": "L31/attn", "start_us": 2018526.2, "dur_us": 73.6}, {"name": "L31/o_proj", "start_us": 2018609.6, "dur_us": 62.8}, {"name": "L31/res1", "start_us": 2018678.4, "dur_us": 48.6}, {"name": "L31/norm2", "start_us": 2018734.0, "dur_us": 53.2}, {"name": "L31/mlp", "start_us": 2018800.3, "dur_us": 57.3}, {"name": "L31/mlp", "start_us": 2018864.3, "dur_us": 51.4}, {"name": "L31/mlp", "start_us": 2018922.0, "dur_us": 56.4}, {"name": "L31/res2", "start_us": 2018982.6, "dur_us": 42.0}, {"name": "final_norm", "start_us": 2019035.0, "dur_us": 48.1}, {"name": "lm_head", "start_us": 2036974.2, "dur_us": 38692.7}, {"name": "lm_head", "start_us": 2093290.4, "dur_us": 36016.2}, {"name": "lm_head", "start_us": 2149779.5, "dur_us": 33693.2}, {"name": "lm_head", "start_us": 2185530.2, "dur_us": 1619.9}];
const gpuHW=/*GPU_HW*/[{"name": "prefill/L0/norm1", "start_us": 25602.104, "dur_us": 13.664}, {"name": "prefill/L0/qkv", "start_us": 727547.768, "dur_us": 216.48}, {"name": "prefill/L0/rope_q", "start_us": 728066.968, "dur_us": 7.616}, {"name": "prefill/L0/rope_kv", "start_us": 728263.832, "dur_us": 5.728}, {"name": "prefill/L0/attn", "start_us": 728442.808, "dur_us": 4.064}, {"name": "prefill/L0/o_proj", "start_us": 728502.04, "dur_us": 123.136}, {"name": "prefill/L0/res1", "start_us": 728640.024, "dur_us": 1.952}, {"name": "prefill/L0/norm2", "start_us": 728690.104, "dur_us": 28.96}, {"name": "prefill/L0/mlp", "start_us": 728789.528, "dur_us": 528.224}, {"name": "prefill/L0/mlp", "start_us": 729337.784, "dur_us": 6.688}, {"name": "prefill/L0/mlp", "start_us": 729358.168, "dur_us": 453.312}, {"name": "prefill/L0/res2", "start_us": 729830.968, "dur_us": 4.832}, {"name": "prefill/L1/norm1", "start_us": 766101.304, "dur_us": 376.0}, {"name": "prefill/L1/qkv", "start_us": 776518.52, "dur_us": 424.224}, {"name": "prefill/L1/rope_q", "start_us": 780256.248, "dur_us": 6.08}, {"name": "prefill/L1/rope_kv", "start_us": 780416.024, "dur_us": 5.6}, {"name": "prefill/L1/attn", "start_us": 780611.096, "dur_us": 6.336}, {"name": "prefill/L1/o_proj", "start_us": 780692.024, "dur_us": 182.24}, {"name": "prefill/L1/res1", "start_us": 780884.632, "dur_us": 2.304}, {"name": "prefill/L1/norm2", "start_us": 780896.984, "dur_us": 27.904}, {"name": "prefill/L1/mlp", "start_us": 780937.752, "dur_us": 645.856}, {"name": "prefill/L1/mlp", "start_us": 781666.808, "dur_us": 6.432}, {"name": "prefill/L1/mlp", "start_us": 781731.864, "dur_us": 158.336}, {"name": "prefill/L1/res2", "start_us": 781903.448, "dur_us": 1.984}, {"name": "prefill/L2/norm1", "start_us": 808075.352, "dur_us": 602.432}, {"name": "prefill/L2/qkv", "start_us": 819525.368, "dur_us": 281.696}, {"name": "prefill/L2/rope_q", "start_us": 822688.216, "dur_us": 12.224}, {"name": "prefill/L2/rope_kv", "start_us": 822827.192, "dur_us": 3.744}, {"name": "prefill/L2/attn", "start_us": 822949.496, "dur_us": 4.416}, {"name": "prefill/L2/o_proj", "start_us": 823042.712, "dur_us": 182.944}, {"name": "prefill/L2/res1", "start_us": 823235.512, "dur_us": 1.952}, {"name": "prefill/L2/norm2", "start_us": 823247.48, "dur_us": 29.312}, {"name": "prefill/L2/mlp", "start_us": 823288.312, "dur_us": 1114.752}, {"name": "prefill/L2/mlp", "start_us": 824421.688, "dur_us": 6.624}, {"name": "prefill/L2/mlp", "start_us": 824444.6, "dur_us": 230.88}, {"name": "prefill/L2/res2", "start_us": 824688.12, "dur_us": 5.536}, {"name": "prefill/L3/norm1", "start_us": 849922.456, "dur_us": 62.176}, {"name": "prefill/L3/qkv", "start_us": 858857.336, "dur_us": 290.912}, {"name": "prefill/L3/rope_q", "start_us": 862159.768, "dur_us": 6.048}, {"name": "prefill/L3/rope_kv", "start_us": 862328.408, "dur_us": 6.304}, {"name": "prefill/L3/attn", "start_us": 862472.216, "dur_us": 6.016}, {"name": "prefill/L3/o_proj", "start_us": 862587.416, "dur_us": 178.08}, {"name": "prefill/L3/res1", "start_us": 862777.848, "dur_us": 1.984}, {"name": "prefill/L3/norm2", "start_us": 862790.168, "dur_us": 28.416}, {"name": "prefill/L3/mlp", "start_us": 862831.096, "dur_us": 383.328}, {"name": "prefill/L3/mlp", "start_us": 863246.008, "dur_us": 12.576}, {"name": "prefill/L3/mlp", "start_us": 863272.472, "dur_us": 640.832}, {"name": "prefill/L3/res2", "start_us": 863926.808, "dur_us": 4.224}, {"name": "prefill/L4/norm1", "start_us": 888881.784, "dur_us": 374.688}, {"name": "prefill/L4/qkv", "start_us": 899694.68, "dur_us": 283.296}, {"name": "prefill/L4/rope_q", "start_us": 902702.424, "dur_us": 11.84}, {"name": "prefill/L4/rope_kv", "start_us": 902842.904, "dur_us": 6.464}, {"name": "prefill/L4/attn", "start_us": 902977.72, "dur_us": 4.672}, {"name": "prefill/L4/o_proj", "start_us": 903086.648, "dur_us": 181.728}, {"name": "prefill/L4/res1", "start_us": 903278.808, "dur_us": 1.92}, {"name": "prefill/L4/norm2", "start_us": 903290.424, "dur_us": 28.512}, {"name": "prefill/L4/mlp", "start_us": 903372.408, "dur_us": 576.896}, {"name": "prefill/L4/mlp", "start_us": 903965.176, "dur_us": 6.304}, {"name": "prefill/L4/mlp", "start_us": 903983.64, "dur_us": 190.72}, {"name": "prefill/L4/res2", "start_us": 904205.24, "dur_us": 15.008}, {"name": "prefill/L5/norm1", "start_us": 930801.592, "dur_us": 532.448}, {"name": "prefill/L5/qkv", "start_us": 940764.024, "dur_us": 375.808}, {"name": "prefill/L5/rope_q", "start_us": 944324.632, "dur_us": 8.672}, {"name": "prefill/L5/rope_kv", "start_us": 944492.44, "dur_us": 5.472}, {"name": "prefill/L5/attn", "start_us": 944641.56, "dur_us": 5.312}, {"name": "prefill/L5/o_proj", "start_us": 944703.0, "dur_us": 176.064}, {"name": "prefill/L5/res1", "start_us": 944890.648, "dur_us": 1.952}, {"name": "prefill/L5/norm2", "start_us": 944902.776, "dur_us": 27.84}, {"name": "prefill/L5/mlp", "start_us": 944943.64, "dur_us": 1018.912}, {"name": "prefill/L5/mlp", "start_us": 945981.624, "dur_us": 7.136}, {"name": "prefill/L5/mlp", "start_us": 946002.456, "dur_us": 151.584}, {"name": "prefill/L5/res2", "start_us": 946168.376, "dur_us": 6.208}, {"name": "prefill/L6/norm1", "start_us": 972818.712, "dur_us": 57.568}, {"name": "prefill/L6/qkv", "start_us": 982563.608, "dur_us": 287.424}, {"name": "prefill/L6/rope_q", "start_us": 986031.0, "dur_us": 8.864}, {"name": "prefill/L6/rope_kv", "start_us": 986227.256, "dur_us": 6.336}, {"name": "prefill/L6/attn", "start_us": 986400.28, "dur_us": 4.736}, {"name": "prefill/L6/o_proj", "start_us": 986532.504, "dur_us": 181.344}, {"name": "prefill/L6/res1", "start_us": 986724.888, "dur_us": 1.984}, {"name": "prefill/L6/norm2", "start_us": 986760.696, "dur_us": 29.536}, {"name": "prefill/L6/mlp", "start_us": 986835.48, "dur_us": 518.368}, {"name": "prefill/L6/mlp", "start_us": 987372.056, "dur_us": 7.424}, {"name": "prefill/L6/mlp", "start_us": 987392.536, "dur_us": 167.36}, {"name": "prefill/L6/res2", "start_us": 987577.912, "dur_us": 8.416}, {"name": "prefill/L7/norm1", "start_us": 1015517.624, "dur_us": 57.216}, {"name": "prefill/L7/qkv", "start_us": 1025204.088, "dur_us": 290.56}, {"name": "prefill/L7/rope_q", "start_us": 1028144.152, "dur_us": 5.856}, {"name": "prefill/L7/rope_kv", "start_us": 1028288.696, "dur_us": 5.6}, {"name": "prefill/L7/attn", "start_us": 1028410.2, "dur_us": 5.6}, {"name": "prefill/L7/o_proj", "start_us": 1028506.36, "dur_us": 178.944}, {"name": "prefill/L7/res1", "start_us": 1028698.968, "dur_us": 1.952}, {"name": "prefill/L7/norm2", "start_us": 1028710.968, "dur_us": 28.448}, {"name": "prefill/L7/mlp", "start_us": 1028751.864, "dur_us": 520.768}, {"name": "prefill/L7/mlp", "start_us": 1029313.24, "dur_us": 18.624}, {"name": "prefill/L7/mlp", "start_us": 1029352.984, "dur_us": 650.976}, {"name": "prefill/L7/res2", "start_us": 1030018.552, "dur_us": 4.128}, {"name": "prefill/L8/norm1", "start_us": 1055065.048, "dur_us": 662.336}, {"name": "prefill/L8/qkv", "start_us": 1066034.04, "dur_us": 286.4}, {"name": "prefill/L8/rope_q", "start_us": 1068998.552, "dur_us": 7.328}, {"name": "prefill/L8/rope_kv", "start_us": 1069107.192, "dur_us": 5.792}, {"name": "prefill/L8/attn", "start_us": 1069205.496, "dur_us": 4.416}, {"name": "prefill/L8/o_proj", "start_us": 1069273.624, "dur_us": 179.488}, {"name": "prefill/L8/res1", "start_us": 1069466.168, "dur_us": 1.92}, {"name": "prefill/L8/norm2", "start_us": 1069478.424, "dur_us": 27.584}, {"name": "prefill/L8/mlp", "start_us": 1069519.384, "dur_us": 889.12}, {"name": "prefill/L8/mlp", "start_us": 1070430.936, "dur_us": 10.976}, {"name": "prefill/L8/mlp", "start_us": 1070461.528, "dur_us": 440.32}, {"name": "prefill/L8/res2", "start_us": 1070918.168, "dur_us": 6.144}, {"name": "prefill/L9/norm1", "start_us": 1097168.6, "dur_us": 57.536}, {"name": "prefill/L9/qkv", "start_us": 1106660.216, "dur_us": 397.568}, {"name": "prefill/L9/rope_q", "start_us": 1110138.872, "dur_us": 6.144}, {"name": "prefill/L9/rope_kv", "start_us": 1110259.864, "dur_us": 5.952}, {"name": "prefill/L9/attn", "start_us": 1110376.024, "dur_us": 5.856}, {"name": "prefill/L9/o_proj", "start_us": 1110465.08, "dur_us": 178.08}, {"name": "prefill/L9/res1", "start_us": 1110654.776, "dur_us": 1.984}, {"name": "prefill/L9/norm2", "start_us": 1110666.808, "dur_us": 27.616}, {"name": "prefill/L9/mlp", "start_us": 1110707.704, "dur_us": 1157.568}, {"name": "prefill/L9/mlp", "start_us": 1111882.904, "dur_us": 5.888}, {"name": "prefill/L9/mlp", "start_us": 1111903.736, "dur_us": 131.104}, {"name": "prefill/L9/res2", "start_us": 1112047.096, "dur_us": 3.392}, {"name": "prefill/L10/norm1", "start_us": 1136354.648, "dur_us": 263.872}, {"name": "prefill/L10/qkv", "start_us": 1148277.976, "dur_us": 282.848}, {"name": "prefill/L10/rope_q", "start_us": 1151256.568, "dur_us": 9.536}, {"name": "prefill/L10/rope_kv", "start_us": 1151421.336, "dur_us": 6.464}, {"name": "prefill/L10/attn", "start_us": 1151566.136, "dur_us": 4.288}, {"name": "prefill/L10/o_proj", "start_us": 1151641.112, "dur_us": 179.456}, {"name": "prefill/L10/res1", "start_us": 1151830.552, "dur_us": 1.952}, {"name": "prefill/L10/norm2", "start_us": 1151842.904, "dur_us": 28.736}, {"name": "prefill/L10/mlp", "start_us": 1151883.832, "dur_us": 1141.376}, {"name": "prefill/L10/mlp", "start_us": 1153043.896, "dur_us": 7.36}, {"name": "prefill/L10/mlp", "start_us": 1153068.568, "dur_us": 185.536}, {"name": "prefill/L10/res2", "start_us": 1153267.224, "dur_us": 5.216}, {"name": "prefill/L11/norm1", "start_us": 1179077.528, "dur_us": 566.944}, {"name": "prefill/L11/qkv", "start_us": 1189507.832, "dur_us": 455.968}, {"name": "prefill/L11/rope_q", "start_us": 1193185.848, "dur_us": 5.536}, {"name": "prefill/L11/rope_kv", "start_us": 1193206.296, "dur_us": 5.728}, {"name": "prefill/L11/attn", "start_us": 1193268.696, "dur_us": 5.696}, {"name": "prefill/L11/o_proj", "start_us": 1193364.248, "dur_us": 181.6}, {"name": "prefill/L11/res1", "start_us": 1193560.568, "dur_us": 1.92}, {"name": "prefill/L11/norm2", "start_us": 1193572.984, "dur_us": 28.352}, {"name": "prefill/L11/mlp", "start_us": 1193614.232, "dur_us": 1323.936}, {"name": "prefill/L11/mlp", "start_us": 1194957.08, "dur_us": 6.624}, {"name": "prefill/L11/mlp", "start_us": 1194977.784, "dur_us": 199.744}, {"name": "prefill/L11/res2", "start_us": 1195190.84, "dur_us": 3.488}, {"name": "prefill/L12/norm1", "start_us": 1219890.936, "dur_us": 311.04}, {"name": "prefill/L12/qkv", "start_us": 1230780.888, "dur_us": 294.272}, {"name": "prefill/L12/rope_q", "start_us": 1234407.768, "dur_us": 13.536}, {"name": "prefill/L12/rope_kv", "start_us": 1234619.96, "dur_us": 5.76}, {"name": "prefill/L12/attn", "start_us": 1234747.352, "dur_us": 4.416}, {"name": "prefill/L12/o_proj", "start_us": 1234837.336, "dur_us": 180.384}, {"name": "prefill/L12/res1", "start_us": 1235028.152, "dur_us": 2.336}, {"name": "prefill/L12/norm2", "start_us": 1235041.816, "dur_us": 28.32}, {"name": "prefill/L12/mlp", "start_us": 1235082.744, "dur_us": 1145.984}, {"name": "prefill/L12/mlp", "start_us": 1236246.808, "dur_us": 7.2}, {"name": "prefill/L12/mlp", "start_us": 1236267.544, "dur_us": 152.0}, {"name": "prefill/L12/res2", "start_us": 1236431.384, "dur_us": 4.512}, {"name": "prefill/L13/norm1", "start_us": 1264099.448, "dur_us": 57.152}, {"name": "prefill/L13/qkv", "start_us": 1273324.664, "dur_us": 351.264}, {"name": "prefill/L13/rope_q", "start_us": 1277503.032, "dur_us": 5.568}, {"name": "prefill/L13/rope_kv", "start_us": 1277538.904, "dur_us": 6.08}, {"name": "prefill/L13/attn", "start_us": 1277702.712, "dur_us": 5.344}, {"name": "prefill/L13/o_proj", "start_us": 1277798.904, "dur_us": 179.808}, {"name": "prefill/L13/res1", "start_us": 1277993.496, "dur_us": 1.952}, {"name": "prefill/L13/norm2", "start_us": 1278005.784, "dur_us": 27.104}, {"name": "prefill/L13/mlp", "start_us": 1278044.664, "dur_us": 1435.2}, {"name": "prefill/L13/mlp", "start_us": 1279502.072, "dur_us": 8.384}, {"name": "prefill/L13/mlp", "start_us": 1279524.344, "dur_us": 392.224}, {"name": "prefill/L13/res2", "start_us": 1279929.848, "dur_us": 3.744}, {"name": "prefill/L14/norm1", "start_us": 1303564.92, "dur_us": 366.56}, {"name": "prefill/L14/qkv", "start_us": 1314422.648, "dur_us": 284.032}, {"name": "prefill/L14/rope_q", "start_us": 1317374.008, "dur_us": 9.376}, {"name": "prefill/L14/rope_kv", "start_us": 1317520.92, "dur_us": 5.856}, {"name": "prefill/L14/attn", "start_us": 1317681.656, "dur_us": 4.32}, {"name": "prefill/L14/o_proj", "start_us": 1317751.832, "dur_us": 182.272}, {"name": "prefill/L14/res1", "start_us": 1317945.88, "dur_us": 1.952}, {"name": "prefill/L14/norm2", "start_us": 1317958.2, "dur_us": 27.872}, {"name": "prefill/L14/mlp", "start_us": 1317999.096, "dur_us": 1112.672}, {"name": "prefill/L14/mlp", "start_us": 1319129.304, "dur_us": 7.296}, {"name": "prefill/L14/mlp", "start_us": 1319152.12, "dur_us": 271.264}, {"name": "prefill/L14/res2", "start_us": 1319436.792, "dur_us": 4.8}, {"name": "prefill/L15/norm1", "start_us": 1345024.824, "dur_us": 56.512}, {"name": "prefill/L15/qkv", "start_us": 1354990.84, "dur_us": 461.344}, {"name": "prefill/L15/rope_q", "start_us": 1358667.32, "dur_us": 6.304}, {"name": "prefill/L15/rope_kv", "start_us": 1358689.656, "dur_us": 7.744}, {"name": "prefill/L15/attn", "start_us": 1358710.296, "dur_us": 6.272}, {"name": "prefill/L15/o_proj", "start_us": 1358788.44, "dur_us": 181.984}, {"name": "prefill/L15/res1", "start_us": 1358984.728, "dur_us": 4.32}, {"name": "prefill/L15/norm2", "start_us": 1359001.144, "dur_us": 28.256}, {"name": "prefill/L15/mlp", "start_us": 1359040.504, "dur_us": 1434.208}, {"name": "prefill/L15/mlp", "start_us": 1360490.648, "dur_us": 4.288}, {"name": "prefill/L15/mlp", "start_us": 1360507.448, "dur_us": 107.712}, {"name": "prefill/L15/res2", "start_us": 1360630.296, "dur_us": 5.536}, {"name": "prefill/L16/norm1", "start_us": 1384259.992, "dur_us": 350.464}, {"name": "prefill/L16/qkv", "start_us": 1395232.76, "dur_us": 427.072}, {"name": "prefill/L16/rope_q", "start_us": 1398625.528, "dur_us": 9.536}, {"name": "prefill/L16/rope_kv", "start_us": 1398727.224, "dur_us": 5.92}, {"name": "prefill/L16/attn", "start_us": 1398831.192, "dur_us": 4.32}, {"name": "prefill/L16/o_proj", "start_us": 1398913.56, "dur_us": 181.44}, {"name": "prefill/L16/res1", "start_us": 1399106.04, "dur_us": 1.952}, {"name": "prefill/L16/norm2", "start_us": 1399118.392, "dur_us": 27.936}, {"name": "prefill/L16/mlp", "start_us": 1399159.288, "dur_us": 1147.296}, {"name": "prefill/L16/mlp", "start_us": 1400325.08, "dur_us": 7.488}, {"name": "prefill/L16/mlp", "start_us": 1400346.136, "dur_us": 199.712}, {"name": "prefill/L16/res2", "start_us": 1400559.128, "dur_us": 5.088}, {"name": "prefill/L17/norm1", "start_us": 1427538.776, "dur_us": 137.536}, {"name": "prefill/L17/qkv", "start_us": 1436511.352, "dur_us": 288.704}, {"name": "prefill/L17/rope_q", "start_us": 1440725.688, "dur_us": 5.888}, {"name": "prefill/L17/rope_kv", "start_us": 1440746.04, "dur_us": 5.888}, {"name": "prefill/L17/attn", "start_us": 1440803.672, "dur_us": 5.248}, {"name": "prefill/L17/o_proj", "start_us": 1440853.528, "dur_us": 181.312}, {"name": "prefill/L17/res1", "start_us": 1441050.104, "dur_us": 5.12}, {"name": "prefill/L17/norm2", "start_us": 1441068.792, "dur_us": 28.064}, {"name": "prefill/L17/mlp", "start_us": 1441107.48, "dur_us": 1208.416}, {"name": "prefill/L17/mlp", "start_us": 1442334.904, "dur_us": 2.432}, {"name": "prefill/L17/mlp", "start_us": 1442349.592, "dur_us": 260.608}, {"name": "prefill/L17/res2", "start_us": 1442624.024, "dur_us": 3.744}, {"name": "prefill/L18/norm1", "start_us": 1466966.904, "dur_us": 262.944}, {"name": "prefill/L18/qkv", "start_us": 1478297.912, "dur_us": 287.392}, {"name": "prefill/L18/rope_q", "start_us": 1481609.656, "dur_us": 12.32}, {"name": "prefill/L18/rope_kv", "start_us": 1481722.808, "dur_us": 3.808}, {"name": "prefill/L18/attn", "start_us": 1481819.768, "dur_us": 4.384}, {"name": "prefill/L18/o_proj", "start_us": 1481886.488, "dur_us": 179.936}, {"name": "prefill/L18/res1", "start_us": 1482076.696, "dur_us": 1.92}, {"name": "prefill/L18/norm2", "start_us": 1482088.984, "dur_us": 27.232}, {"name": "prefill/L18/mlp", "start_us": 1482127.896, "dur_us": 1056.672}, {"name": "prefill/L18/mlp", "start_us": 1483203.832, "dur_us": 7.328}, {"name": "prefill/L18/mlp", "start_us": 1483226.648, "dur_us": 141.44}, {"name": "prefill/L18/res2", "start_us": 1483380.216, "dur_us": 4.928}, {"name": "prefill/L19/norm1", "start_us": 1509514.424, "dur_us": 57.056}, {"name": "prefill/L19/qkv", "start_us": 1518461.016, "dur_us": 290.4}, {"name": "prefill/L19/rope_q", "start_us": 1522023.8, "dur_us": 8.992}, {"name": "prefill/L19/rope_kv", "start_us": 1522149.912, "dur_us": 5.664}, {"name": "prefill/L19/attn", "start_us": 1522255.672, "dur_us": 5.76}, {"name": "prefill/L19/o_proj", "start_us": 1522327.096, "dur_us": 180.096}, {"name": "prefill/L19/res1", "start_us": 1522518.104, "dur_us": 1.92}, {"name": "prefill/L19/norm2", "start_us": 1522529.848, "dur_us": 28.64}, {"name": "prefill/L19/mlp", "start_us": 1522570.776, "dur_us": 1278.432}, {"name": "prefill/L19/mlp", "start_us": 1523868.984, "dur_us": 6.016}, {"name": "prefill/L19/mlp", "start_us": 1523889.688, "dur_us": 79.712}, {"name": "prefill/L19/res2", "start_us": 1523981.912, "dur_us": 3.776}, {"name": "prefill/L20/norm1", "start_us": 1550244.664, "dur_us": 57.792}, {"name": "prefill/L20/qkv", "start_us": 1560291.096, "dur_us": 286.144}, {"name": "prefill/L20/rope_q", "start_us": 1563365.624, "dur_us": 10.624}, {"name": "prefill/L20/rope_kv", "start_us": 1563566.648, "dur_us": 5.888}, {"name": "prefill/L20/attn", "start_us": 1563695.64, "dur_us": 4.8}, {"name": "prefill/L20/o_proj", "start_us": 1563764.856, "dur_us": 181.792}, {"name": "prefill/L20/res1", "start_us": 1563956.984, "dur_us": 1.952}, {"name": "prefill/L20/norm2", "start_us": 1563969.24, "dur_us": 27.264}, {"name": "prefill/L20/mlp", "start_us": 1564007.96, "dur_us": 1122.368}, {"name": "prefill/L20/mlp", "start_us": 1565150.488, "dur_us": 7.264}, {"name": "prefill/L20/mlp", "start_us": 1565173.272, "dur_us": 239.424}, {"name": "prefill/L20/res2", "start_us": 1565425.4, "dur_us": 5.92}, {"name": "prefill/L21/norm1", "start_us": 1589159.096, "dur_us": 438.592}, {"name": "prefill/L21/qkv", "start_us": 1599412.984, "dur_us": 286.56}, {"name": "prefill/L21/rope_q", "start_us": 1602862.392, "dur_us": 7.808}, {"name": "prefill/L21/rope_kv", "start_us": 1603067.704, "dur_us": 5.568}, {"name": "prefill/L21/attn", "start_us": 1603247.96, "dur_us": 5.568}, {"name": "prefill/L21/o_proj", "start_us": 1603393.048, "dur_us": 180.608}, {"name": "prefill/L21/res1", "start_us": 1603586.392, "dur_us": 4.608}, {"name": "prefill/L21/norm2", "start_us": 1603601.944, "dur_us": 28.512}, {"name": "prefill/L21/mlp", "start_us": 1603712.76, "dur_us": 941.504}, {"name": "prefill/L21/mlp", "start_us": 1604697.592, "dur_us": 16.288}, {"name": "prefill/L21/mlp", "start_us": 1604729.624, "dur_us": 521.088}, {"name": "prefill/L21/res2", "start_us": 1605261.816, "dur_us": 3.456}, {"name": "prefill/L22/norm1", "start_us": 1630472.824, "dur_us": 57.44}, {"name": "prefill/L22/qkv", "start_us": 1639647.128, "dur_us": 287.584}, {"name": "prefill/L22/rope_q", "start_us": 1643079.32, "dur_us": 7.808}, {"name": "prefill/L22/rope_kv", "start_us": 1643143.768, "dur_us": 5.92}, {"name": "prefill/L22/attn", "start_us": 1643344.376, "dur_us": 4.384}, {"name": "prefill/L22/o_proj", "start_us": 1643508.312, "dur_us": 183.968}, {"name": "prefill/L22/res1", "start_us": 1643706.872, "dur_us": 1.984}, {"name": "prefill/L22/norm2", "start_us": 1643719.192, "dur_us": 28.992}, {"name": "prefill/L22/mlp", "start_us": 1643760.12, "dur_us": 1256.16}, {"name": "prefill/L22/mlp", "start_us": 1645035.384, "dur_us": 7.936}, {"name": "prefill/L22/mlp", "start_us": 1645056.632, "dur_us": 231.936}, {"name": "prefill/L22/res2", "start_us": 1645298.2, "dur_us": 5.472}, {"name": "prefill/L23/norm1", "start_us": 1670939.416, "dur_us": 56.288}, {"name": "prefill/L23/qkv", "start_us": 1680208.504, "dur_us": 287.072}, {"name": "prefill/L23/rope_q", "start_us": 1683585.592, "dur_us": 5.952}, {"name": "prefill/L23/rope_kv", "start_us": 1683606.072, "dur_us": 3.744}, {"name": "prefill/L23/attn", "start_us": 1683633.048, "dur_us": 5.6}, {"name": "prefill/L23/o_proj", "start_us": 1683724.856, "dur_us": 179.168}, {"name": "prefill/L23/res1", "start_us": 1683918.328, "dur_us": 4.192}, {"name": "prefill/L23/norm2", "start_us": 1683934.904, "dur_us": 27.776}, {"name": "prefill/L23/mlp", "start_us": 1683973.624, "dur_us": 1373.28}, {"name": "prefill/L23/mlp", "start_us": 1685363.832, "dur_us": 6.464}, {"name": "prefill/L23/mlp", "start_us": 1685382.68, "dur_us": 81.216}, {"name": "prefill/L23/res2", "start_us": 1685478.968, "dur_us": 3.616}, {"name": "prefill/L24/norm1", "start_us": 1711171.032, "dur_us": 66.24}, {"name": "prefill/L24/qkv", "start_us": 1720320.888, "dur_us": 324.448}, {"name": "prefill/L24/rope_q", "start_us": 1724007.16, "dur_us": 5.824}, {"name": "prefill/L24/rope_kv", "start_us": 1724030.68, "dur_us": 4.384}, {"name": "prefill/L24/attn", "start_us": 1724046.872, "dur_us": 6.848}, {"name": "prefill/L24/o_proj", "start_us": 1724065.304, "dur_us": 209.344}, {"name": "prefill/L24/res1", "start_us": 1724561.944, "dur_us": 6.272}, {"name": "prefill/L24/norm2", "start_us": 1724580.568, "dur_us": 31.936}, {"name": "prefill/L24/mlp", "start_us": 1724625.432, "dur_us": 1594.24}, {"name": "prefill/L24/mlp", "start_us": 1726241.272, "dur_us": 4.16}, {"name": "prefill/L24/mlp", "start_us": 1726258.68, "dur_us": 78.752}, {"name": "prefill/L24/res2", "start_us": 1726350.904, "dur_us": 7.616}, {"name": "prefill/L25/norm1", "start_us": 1752366.392, "dur_us": 71.008}, {"name": "prefill/L25/qkv", "start_us": 1762331.384, "dur_us": 326.88}, {"name": "prefill/L25/rope_q", "start_us": 1766402.04, "dur_us": 6.016}, {"name": "prefill/L25/rope_kv", "start_us": 1766422.072, "dur_us": 5.792}, {"name": "prefill/L25/attn", "start_us": 1766446.968, "dur_us": 4.416}, {"name": "prefill/L25/o_proj", "start_us": 1766473.208, "dur_us": 204.064}, {"name": "prefill/L25/res1", "start_us": 1766696.504, "dur_us": 6.144}, {"name": "prefill/L25/norm2", "start_us": 1766716.952, "dur_us": 32.704}, {"name": "prefill/L25/mlp", "start_us": 1766762.264, "dur_us": 1689.728}, {"name": "prefill/L25/mlp", "start_us": 1768471.992, "dur_us": 5.504}, {"name": "prefill/L25/mlp", "start_us": 1768490.552, "dur_us": 326.272}, {"name": "prefill/L25/res2", "start_us": 1768828.408, "dur_us": 3.68}, {"name": "prefill/L26/norm1", "start_us": 1795111.32, "dur_us": 63.328}, {"name": "prefill/L26/qkv", "start_us": 1804086.168, "dur_us": 320.384}, {"name": "prefill/L26/rope_q", "start_us": 1807842.904, "dur_us": 5.568}, {"name": "prefill/L26/rope_kv", "start_us": 1807869.816, "dur_us": 5.504}, {"name": "prefill/L26/attn", "start_us": 1807886.872, "dur_us": 4.672}, {"name": "prefill/L26/o_proj", "start_us": 1807926.808, "dur_us": 208.064}, {"name": "prefill/L26/res1", "start_us": 1808149.048, "dur_us": 4.704}, {"name": "prefill/L26/norm2", "start_us": 1808167.448, "dur_us": 29.696}, {"name": "prefill/L26/mlp", "start_us": 1808210.456, "dur_us": 1575.808}, {"name": "prefill/L26/mlp", "start_us": 1809809.208, "dur_us": 4.128}, {"name": "prefill/L26/mlp", "start_us": 1809826.392, "dur_us": 85.216}, {"name": "prefill/L26/res2", "start_us": 1809924.664, "dur_us": 7.072}, {"name": "prefill/L27/norm1", "start_us": 1837004.92, "dur_us": 61.408}, {"name": "prefill/L27/qkv", "start_us": 1847730.072, "dur_us": 329.536}, {"name": "prefill/L27/rope_q", "start_us": 1851170.328, "dur_us": 5.632}, {"name": "prefill/L27/rope_kv", "start_us": 1851246.456, "dur_us": 6.688}, {"name": "prefill/L27/attn", "start_us": 1851598.584, "dur_us": 4.544}, {"name": "prefill/L27/o_proj", "start_us": 1851614.712, "dur_us": 204.192}, {"name": "prefill/L27/res1", "start_us": 1851829.784, "dur_us": 1.952}, {"name": "prefill/L27/norm2", "start_us": 1851844.12, "dur_us": 32.352}, {"name": "prefill/L27/mlp", "start_us": 1851891.192, "dur_us": 1575.872}, {"name": "prefill/L27/mlp", "start_us": 1853484.376, "dur_us": 8.416}, {"name": "prefill/L27/mlp", "start_us": 1853506.104, "dur_us": 256.896}, {"name": "prefill/L27/res2", "start_us": 1853775.352, "dur_us": 3.68}, {"name": "prefill/L28/norm1", "start_us": 1877820.952, "dur_us": 62.336}, {"name": "prefill/L28/qkv", "start_us": 1886935.832, "dur_us": 324.928}, {"name": "prefill/L28/rope_q", "start_us": 1890982.04, "dur_us": 21.12}, {"name": "prefill/L28/rope_kv", "start_us": 1891018.296, "dur_us": 6.592}, {"name": "prefill/L28/attn", "start_us": 1891036.728, "dur_us": 5.888}, {"name": "prefill/L28/o_proj", "start_us": 1891055.16, "dur_us": 200.32}, {"name": "prefill/L28/res1", "start_us": 1891272.376, "dur_us": 6.912}, {"name": "prefill/L28/norm2", "start_us": 1891294.712, "dur_us": 30.496}, {"name": "prefill/L28/mlp", "start_us": 1891339.8, "dur_us": 1471.968}, {"name": "prefill/L28/mlp", "start_us": 1893361.912, "dur_us": 3.424}, {"name": "prefill/L28/mlp", "start_us": 1893378.552, "dur_us": 172.48}, {"name": "prefill/L28/res2", "start_us": 1893562.904, "dur_us": 5.376}, {"name": "prefill/L29/norm1", "start_us": 1919556.184, "dur_us": 68.48}, {"name": "prefill/L29/qkv", "start_us": 1930699.64, "dur_us": 325.984}, {"name": "prefill/L29/rope_q", "start_us": 1933517.336, "dur_us": 7.648}, {"name": "prefill/L29/rope_kv", "start_us": 1933539.864, "dur_us": 4.0}, {"name": "prefill/L29/attn", "start_us": 1933581.016, "dur_us": 6.176}, {"name": "prefill/L29/o_proj", "start_us": 1933652.504, "dur_us": 212.608}, {"name": "prefill/L29/res1", "start_us": 1933878.104, "dur_us": 2.24}, {"name": "prefill/L29/norm2", "start_us": 1933890.104, "dur_us": 33.28}, {"name": "prefill/L29/mlp", "start_us": 1933935.128, "dur_us": 1550.528}, {"name": "prefill/L29/mlp", "start_us": 1935503.512, "dur_us": 6.848}, {"name": "prefill/L29/mlp", "start_us": 1935524.408, "dur_us": 94.08}, {"name": "prefill/L29/res2", "start_us": 1935632.984, "dur_us": 7.104}, {"name": "prefill/L30/norm1", "start_us": 1963959.704, "dur_us": 65.792}, {"name": "prefill/L30/qkv", "start_us": 1973669.752, "dur_us": 323.904}, {"name": "prefill/L30/rope_q", "start_us": 1976804.92, "dur_us": 5.568}, {"name": "prefill/L30/rope_kv", "start_us": 1976825.432, "dur_us": 5.632}, {"name": "prefill/L30/attn", "start_us": 1976882.712, "dur_us": 4.32}, {"name": "prefill/L30/o_proj", "start_us": 1976957.464, "dur_us": 210.176}, {"name": "prefill/L30/res1", "start_us": 1977190.296, "dur_us": 1.92}, {"name": "prefill/L30/norm2", "start_us": 1977203.224, "dur_us": 32.096}, {"name": "prefill/L30/mlp", "start_us": 1977248.28, "dur_us": 1618.56}, {"name": "prefill/L30/mlp", "start_us": 1978884.024, "dur_us": 6.944}, {"name": "prefill/L30/mlp", "start_us": 1978905.304, "dur_us": 318.432}, {"name": "prefill/L30/res2", "start_us": 1979237.912, "dur_us": 8.704}, {"name": "prefill/L31/norm1", "start_us": 2004956.472, "dur_us": 66.208}, {"name": "prefill/L31/qkv", "start_us": 2014813.048, "dur_us": 327.136}, {"name": "prefill/L31/rope_q", "start_us": 2018440.76, "dur_us": 5.504}, {"name": "prefill/L31/rope_kv", "start_us": 2018461.24, "dur_us": 5.824}, {"name": "prefill/L31/attn", "start_us": 2018527.768, "dur_us": 6.432}, {"name": "prefill/L31/o_proj", "start_us": 2018596.376, "dur_us": 201.12}, {"name": "prefill/L31/res1", "start_us": 2018814.936, "dur_us": 1.984}, {"name": "prefill/L31/norm2", "start_us": 2018827.832, "dur_us": 28.512}, {"name": "prefill/L31/mlp", "start_us": 2018868.76, "dur_us": 656.512}, {"name": "prefill/L31/mlp", "start_us": 2019540.664, "dur_us": 9.6}, {"name": "prefill/L31/mlp", "start_us": 2019567.128, "dur_us": 118.944}, {"name": "prefill/L31/res2", "start_us": 2019700.248, "dur_us": 4.384}, {"name": "prefill/final_norm", "start_us": 2019716.856, "dur_us": 33.536}, {"name": "prefill/lm_head", "start_us": 2061615.32, "dur_us": 11827.072}, {"name": "prefill/lm_head", "start_us": 2117213.4, "dur_us": 11834.528}, {"name": "prefill/lm_head", "start_us": 2171337.272, "dur_us": 11841.312}, {"name": "prefill/lm_head", "start_us": 2186308.408, "dur_us": 84.192}];
const steps=/*STEPS*/[{"name": "prefill", "start_us": 0.0, "dur_us": 2187376.3}, {"name": "decode_0", "start_us": 2196864.4, "dur_us": 29381.2}, {"name": "decode_1", "start_us": 2227699.4, "dur_us": 7446.1}, {"name": "decode_2", "start_us": 2236506.0, "dur_us": 7704.0}, {"name": "decode_3", "start_us": 2245653.9, "dur_us": 7615.9}, {"name": "decode_4", "start_us": 2254629.3, "dur_us": 7780.8}, {"name": "decode_5", "start_us": 2263959.5, "dur_us": 7481.6}, {"name": "decode_6", "start_us": 2272893.7, "dur_us": 7381.3}, {"name": "decode_7", "start_us": 2281848.4, "dur_us": 7400.4}, {"name": "decode_8", "start_us": 2290637.0, "dur_us": 7914.5}, {"name": "decode_9", "start_us": 2300051.2, "dur_us": 7793.0}];
const S=/*SUM*/{"total_cpu_ms": 2285.28, "total_gpu_ms": 1282.71, "total_gpu_hw_ms": 104.05, "cpu": [{"name": "sampling", "total_ms": 0.39, "count": 10, "avg_ms": 0.039, "pct": 0.0}, {"name": "embed", "total_ms": 0.04, "count": 1, "avg_ms": 0.04, "pct": 0.0}], "gpu": [{"name": "norm1", "total_ms": 1033.5, "count": 32, "avg_ms": 32.297, "pct": 80.6}, {"name": "lm_head", "total_ms": 110.02, "count": 4, "avg_ms": 27.505, "pct": 8.6}, {"name": "qkv", "total_ms": 109.36, "count": 32, "avg_ms": 3.418, "pct": 8.5}, {"name": "rope_q", "total_ms": 7.38, "count": 32, "avg_ms": 0.231, "pct": 0.6}, {"name": "mlp", "total_ms": 6.96, "count": 96, "avg_ms": 0.072, "pct": 0.5}, {"name": "rope_kv", "total_ms": 3.9, "count": 32, "avg_ms": 0.122, "pct": 0.3}, {"name": "attn", "total_ms": 2.94, "count": 32, "avg_ms": 0.092, "pct": 0.2}, {"name": "o_proj", "total_ms": 2.91, "count": 32, "avg_ms": 0.091, "pct": 0.2}, {"name": "res1", "total_ms": 2.4, "count": 32, "avg_ms": 0.075, "pct": 0.2}, {"name": "norm2", "total_ms": 1.97, "count": 32, "avg_ms": 0.061, "pct": 0.2}, {"name": "res2", "total_ms": 1.33, "count": 32, "avg_ms": 0.042, "pct": 0.1}, {"name": "final_norm", "total_ms": 0.05, "count": 1, "avg_ms": 0.048, "pct": 0.0}], "gpu_hw": [{"name": "mlp", "total_ms": 44.03, "count": 96, "avg_ms": 0.459, "pct": 42.3}, {"name": "lm_head", "total_ms": 35.59, "count": 4, "avg_ms": 8.897, "pct": 34.2}, {"name": "qkv", "total_ms": 10.31, "count": 32, "avg_ms": 0.322, "pct": 9.9}, {"name": "norm1", "total_ms": 6.36, "count": 32, "avg_ms": 0.199, "pct": 6.1}, {"name": "o_proj", "total_ms": 5.93, "count": 32, "avg_ms": 0.185, "pct": 5.7}, {"name": "norm2", "total_ms": 0.93, "count": 32, "avg_ms": 0.029, "pct": 0.9}, {"name": "rope_q", "total_ms": 0.26, "count": 32, "avg_ms": 0.008, "pct": 0.3}, {"name": "rope_kv", "total_ms": 0.18, "count": 32, "avg_ms": 0.006, "pct": 0.2}, {"name": "res2", "total_ms": 0.17, "count": 32, "avg_ms": 0.005, "pct": 0.2}, {"name": "attn", "total_ms": 0.17, "count": 32, "avg_ms": 0.005, "pct": 0.2}, {"name": "res1", "total_ms": 0.09, "count": 32, "avg_ms": 0.003, "pct": 0.1}, {"name": "final_norm", "total_ms": 0.03, "count": 1, "avg_ms": 0.034, "pct": 0.0}], "steps": [{"name": "prefill", "ms": 2187.38}, {"name": "decode_0", "ms": 29.38}, {"name": "decode_1", "ms": 7.45}, {"name": "decode_2", "ms": 7.7}, {"name": "decode_3", "ms": 7.62}, {"name": "decode_4", "ms": 7.78}, {"name": "decode_5", "ms": 7.48}, {"name": "decode_6", "ms": 7.38}, {"name": "decode_7", "ms": 7.4}, {"name": "decode_8", "ms": 7.91}, {"name": "decode_9", "ms": 7.79}], "op_counts": {"prefill_cpu_ops": 1, "prefill_gpu_ops": 389, "decode_cpu_ops": 10, "decode_gpu_ops": 0, "decode_cpu_ops_per_token": 1.0, "decode_gpu_ops_per_token": 0.0, "decode_tokens": 10}};
const A=/*ADP*/{"vendor": "nvidia", "architecture": "blackwell", "device": "NVIDIA GeForce RTX 5080", "description": "D3D12 driver version 32.0.15.9144", "backend": "D3D12", "vendorID": 4318, "deviceID": 11266};
const M=/*MEM*/{"gpu_total_mb": 5666.0, "gpu_weight_mb": 5150.4, "gpu_buffer_cache_mb": 4.9, "gpu_alloc_count": 570, "gpu_weight_count": 455, "gpu_pipeline_count": 31, "cpu_weight_mb": 3977.3};
const dpr=devicePixelRatio||1;

if(A.device)document.getElementById('gpu-chip').textContent=A.device;
if(A.backend)document.getElementById('backend-chip').textContent=A.backend;

// Step cards + op counts
const sc=document.getElementById('step-cards');
if(S.steps&&S.steps.length){
  const decode=S.steps.filter(s=>s.name.startsWith('decode'));
  if(decode.length>0){
    const avgDec=decode.reduce((a,s)=>a+s.ms,0)/decode.length;
    const tps=1000/avgDec;
    let h='';
    h+=`<div class="step-card"><div class="label">Decode</div><div class="value">${tps.toFixed(1)}</div><div class="unit">tok/s</div></div>`;
    h+=`<div class="step-card"><div class="label">Avg/token</div><div class="value">${avgDec.toFixed(1)}</div><div class="unit">ms</div></div>`;
    const pf=S.steps.find(s=>s.name==='prefill');
    if(pf)h+=`<div class="step-card"><div class="label">Prefill</div><div class="value">${pf.ms.toFixed(0)}</div><div class="unit">ms</div></div>`;
    h+=`<div class="step-card"><div class="label">Steps</div><div class="value">${S.steps.length}</div><div class="unit">total</div></div>`;
    const oc=S.op_counts||{};
    if(oc.prefill_gpu_ops)h+=`<div class="step-card"><div class="label">Prefill ops</div><div class="value">${oc.prefill_gpu_ops}</div><div class="unit">GPU / ${oc.prefill_cpu_ops} CPU</div></div>`;
    if(oc.decode_gpu_ops_per_token)h+=`<div class="step-card"><div class="label">Decode ops/tok</div><div class="value">${oc.decode_gpu_ops_per_token}</div><div class="unit">GPU / ${oc.decode_cpu_ops_per_token} CPU</div></div>`;
    if(oc.decode_gpu_ops)h+=`<div class="step-card"><div class="label">Decode total</div><div class="value">${oc.decode_gpu_ops}</div><div class="unit">GPU (${oc.decode_tokens} tok)</div></div>`;
    sc.innerHTML=h;
  }
}

// Colors
const OC={qkv_linear:'#7aa2f7',qkv:'#7aa2f7',gate_up:'#f7768e',down_proj:'#9ece6a',down:'#9ece6a',
  o_proj:'#ff9e64',attention_cpu:'#bb9af7',attn:'#bb9af7',norm1:'#7dcfff',norm2:'#7dcfff',
  res_add_norm:'#73daca',res1:'#73daca',res2:'#73daca',final_norm:'#7dcfff',
  silu_mul_cpu:'#e0af68',silu_mul:'#e0af68',mlp:'#e0af68',
  lm_head:'#f7768e',embed:'#73daca',sampling:'#414868',
  rope_q:'#ff9e64',rope_kv:'#ff9e64',upload_weights:'#414868'};
function oc(n){if(OC[n])return OC[n];let h=0;for(let i=0;i<n.length;i++)h=(h*31+n.charCodeAt(i))&0xffffff;return`hsl(${h%360},55%,60%)`;}

// Layout: 2 lanes — CPU (with step markers as background), GPU
const LW=80, TH=20;
const CPU_Y=6;
const GPU_Y=CPU_Y+TH+4;
const CH=GPU_Y+TH+20;
// Merge GPU events: prefer HW timestamps, fall back to CPU-timed
const gpuMerged=gpuHW.length?gpuHW:gpu;

let allS=cpu.map(e=>e.start_us).concat(gpuMerged.map(e=>e.start_us)).concat(steps.map(e=>e.start_us));
let allE=cpu.map(e=>e.start_us+e.dur_us).concat(gpuMerged.map(e=>e.start_us+e.dur_us)).concat(steps.map(e=>e.start_us+e.dur_us));
let gMin=allS.length?Math.min(...allS):0, gMax=allE.length?Math.max(...allE):1000;

let vS=gMin, vE=gMax, drag=false, dX=0, dVS=0;

function resize(){
  const w=W.clientWidth;
  C.width=w*dpr; C.height=CH*dpr;
  C.style.width=w+'px'; C.style.height=CH+'px';
  X.setTransform(dpr,0,0,dpr,0,0); draw();
}

function t2x(t){return LW+(t-vS)/(vE-vS)*(C.clientWidth-LW);}
function x2t(x){return vS+(x-LW)/(C.clientWidth-LW)*(vE-vS);}

function niceStep(r,mx){
  const rg=r/mx,p=Math.pow(10,Math.floor(Math.log10(rg))),n=rg/p;
  return(n<=1.5?1:n<=3.5?2:n<=7.5?5:10)*p;
}

function drawLane(events, y, getName){
  const w=C.clientWidth;
  for(const e of events){
    const n=getName?getName(e):e.name;
    const x1=t2x(e.start_us),x2=t2x(e.start_us+e.dur_us),bw=Math.max(x2-x1,1);
    if(x2<LW||x1>w)continue;
    X.fillStyle=oc(n); X.fillRect(x1,y+1,bw,TH-2);
    if(bw>24){X.fillStyle='#1a1b26';X.font='8px system-ui';
      X.save();X.beginPath();X.rect(x1,y,bw,TH);X.clip();
      X.fillText(n,x1+2,y+12);X.restore();}
  }
}

function draw(){
  const w=C.clientWidth, range=vE-vS;
  X.clearRect(0,0,w,CH);
  X.fillStyle='#1a1b26'; X.fillRect(0,0,w,CH);

  // Grid + time axis
  const ts=niceStep(range,(w-LW)/80);
  X.font='9px system-ui';
  for(let t=Math.ceil(vS/ts)*ts;t<=vE;t+=ts){
    const x=t2x(t);
    X.fillStyle='#292e42'; X.fillRect(x,0,1,CH);
    X.fillStyle='#565f89';
    const lb=t>=1e6?(t/1e6).toFixed(1)+'s':t>=1e3?(t/1e3).toFixed(1)+'ms':t.toFixed(0)+'us';
    X.fillText(lb,x+2,CH-3);
  }

  // Lane labels
  X.fillStyle='#565f89'; X.font='10px system-ui';
  X.fillText('CPU',4,CPU_Y+14);
  X.fillText('GPU',4,GPU_Y+14);

  // Lane bg
  X.fillStyle='#1f2335';
  X.fillRect(LW,CPU_Y,w-LW,TH);
  X.fillRect(LW,GPU_Y,w-LW,TH);

  // Step markers as background bands in BOTH lanes
  // Prefill = green-tinted, Decode = blue-tinted (obvious differentiation)
  for(const s of steps){
    const x1=t2x(s.start_us),x2=t2x(s.start_us+s.dur_us),bw=Math.max(x2-x1,1);
    if(x2<LW||x1>w)continue;
    const isPrefill=s.name==='prefill';
    const bandColor=isPrefill?'rgba(158,206,106,0.12)':'rgba(122,162,247,0.08)';
    const borderColor=isPrefill?'rgba(158,206,106,0.35)':'rgba(122,162,247,0.25)';
    const labelColor=isPrefill?'#9ece6a':'#7aa2f7';
    // CPU lane band
    X.fillStyle=bandColor;
    X.fillRect(x1,CPU_Y,bw,TH);
    // GPU lane band (same phase coloring)
    X.fillRect(x1,GPU_Y,bw,TH);
    // Phase border line
    X.strokeStyle=borderColor; X.lineWidth=1;
    X.beginPath();X.moveTo(x1,CPU_Y);X.lineTo(x1,GPU_Y+TH);X.stroke();
    // Phase label — show at top of CPU lane
    if(bw>24){X.fillStyle=labelColor;X.font='bold 9px system-ui';X.fillText(s.name,x1+3,CPU_Y+10);}
  }

  // CPU lane (ops on top of step bands)
  drawLane(cpu, CPU_Y, e=>e.name);

  // GPU lane (merged: HW timestamps if available, else CPU-timed)
  drawLane(gpuMerged, GPU_Y, e=>e.name.split('/').pop());

  // Connector lines: link CPU recording to GPU execution
  // Draws dashed lines from CPU bar bottom-center to GPU bar top-center
  // for events that share a "link" id
  const cpuLinks={}, gpuLinks={};
  for(const e of cpu){if(e.link){const cx=t2x(e.start_us+e.dur_us/2);if(cx>=LW&&cx<=w)cpuLinks[e.link]={x:cx,x1:t2x(e.start_us),x2:t2x(e.start_us+e.dur_us),name:e.name};}}
  for(const e of gpuMerged){if(e.link){const cx=t2x(e.start_us+e.dur_us/2);if(cx>=LW&&cx<=w)gpuLinks[e.link]={x:cx,x1:t2x(e.start_us),x2:t2x(e.start_us+e.dur_us),name:e.name};}}
  X.save();
  X.setLineDash([3,3]);
  X.lineWidth=0.8;
  for(const id in cpuLinks){
    if(!gpuLinks[id])continue;
    const c=cpuLinks[id],g=gpuLinks[id];
    // Color: match the op color
    X.strokeStyle=oc(c.name);
    X.globalAlpha=0.6;
    // Draw from CPU bar bottom to GPU bar top
    X.beginPath();
    X.moveTo(c.x, CPU_Y+TH);
    X.lineTo(g.x, GPU_Y);
    X.stroke();
  }
  X.restore();

  document.getElementById('range-label').textContent=
    range>=1e6?(range/1e6).toFixed(2)+'s':(range/1e3).toFixed(1)+'ms';
}

// Zoom/pan
C.addEventListener('wheel',ev=>{
  ev.preventDefault();
  const f=ev.deltaY>0?1.25:0.8,mx=ev.offsetX,t=x2t(mx);
  const nr=(vE-vS)*f,fr=(mx-LW)/(C.clientWidth-LW);
  vS=t-fr*nr;vE=vS+nr;draw();
});
C.addEventListener('mousedown',ev=>{drag=true;dX=ev.clientX;dVS=vS;W.classList.add('dragging');});
addEventListener('mousemove',ev=>{
  if(drag){const dx=ev.clientX-dX,r=vE-vS;vS=dVS-dx/(C.clientWidth-LW)*r;vE=vS+r;draw();}
  const rc=C.getBoundingClientRect(),mx=ev.clientX-rc.left,my=ev.clientY-rc.top,t=x2t(mx);
  let hit=null;
  if(my>=CPU_Y&&my<CPU_Y+TH){
    for(const e of cpu)if(t>=e.start_us&&t<=e.start_us+e.dur_us){hit={...e,type:'CPU'};break;}
    if(!hit){for(const s of steps)if(t>=s.start_us&&t<=s.start_us+s.dur_us){hit={name:s.name,dur_us:s.dur_us,type:'Step'};break;}}
  }else if(my>=GPU_Y&&my<GPU_Y+TH){
    for(const e of gpuMerged)if(t>=e.start_us&&t<=e.start_us+e.dur_us){hit={name:e.name.split('/').pop(),scope:e.name,dur_us:e.dur_us,type:gpuHW.length?'GPU (hw)':'GPU (sub)'};break;}
  }
  if(hit){
    const d=hit.dur_us>=1000?(hit.dur_us/1000).toFixed(2)+' ms':hit.dur_us.toFixed(1)+' us';
    let h=`<b>${hit.name}</b>`;
    if(hit.scope)h+=`<br><span class="dim">${hit.scope}</span>`;
    h+=`<br>${hit.type}: ${d}`;
    TT.innerHTML=h;TT.style.display='block';
    TT.style.left=(ev.clientX+12)+'px';TT.style.top=(ev.clientY-10)+'px';
  }else TT.style.display='none';
});
addEventListener('mouseup',()=>{drag=false;W.classList.remove('dragging');});

function resetZoom(){vS=gMin;vE=gMax;draw();}
function zoomIn(){const m=(vS+vE)/2,r=(vE-vS)/2;vS=m-r/2;vE=m+r/2;draw();}
function zoomOut(){const m=(vS+vE)/2,r=(vE-vS)*2;vS=m-r/2;vE=m+r/2;draw();}

// Summary tables
function fillTbl(id,data,tCol,aCol){
  const tb=document.querySelector('#'+id+' tbody');
  if(!data||!data.length){tb.innerHTML='<tr><td colspan="6" style="color:var(--fg3)">No data</td></tr>';return;}
  tb.innerHTML=data.map(d=>{
    const tv=d[tCol],av=d[aCol];
    const tu=tCol.includes('ms')?'ms':'us',au=aCol.includes('ms')?'ms':'us';
    return`<tr><td>${d.name}</td><td class="r">${tv>=1?tv.toFixed(1):tv.toFixed(2)} ${tu}</td>
    <td class="r">${d.count}x</td><td class="r">${av>=1?av.toFixed(2):av.toFixed(3)} ${au}</td>
    <td class="r">${d.pct.toFixed(1)}%</td>
    <td><div class="bar" style="width:${Math.max(d.pct,1)}%;background:${oc(d.name)}"></div></td></tr>`;
  }).join('');
}
fillTbl('cpu-tbl',S.cpu,'total_ms','avg_ms');
// Use HW timestamp summary if available, else CPU-timed dispatch summary
fillTbl('gpu-tbl',S.gpu_hw&&S.gpu_hw.length?S.gpu_hw:S.gpu,'total_ms','avg_ms');

// Memory info panel
const mp=document.getElementById('mem-info');
if(M&&M.gpu_total_mb){
  const rows=[
    ['GPU Total Allocated',M.gpu_total_mb>=1024?(M.gpu_total_mb/1024).toFixed(2)+' GB':M.gpu_total_mb+' MB'],
    ['GPU Weights',M.gpu_weight_mb>=1024?(M.gpu_weight_mb/1024).toFixed(2)+' GB':M.gpu_weight_mb+' MB'],
    ['GPU Buffer Cache',M.gpu_buffer_cache_mb.toFixed(1)+' MB'],
    ['GPU Allocations',M.gpu_alloc_count],
    ['Weight Tensors',M.gpu_weight_count],
    ['Compiled Pipelines',M.gpu_pipeline_count],
    ['CPU Weights',M.cpu_weight_mb>=1024?(M.cpu_weight_mb/1024).toFixed(2)+' GB':M.cpu_weight_mb+' MB'],
  ];
  mp.innerHTML='<table style="width:100%;font-size:11px;border-collapse:collapse">'+rows.map(([k,v])=>
    `<tr><td style="padding:3px 6px;color:var(--fg2);border-bottom:1px solid var(--bg)">${k}</td><td class="r" style="padding:3px 6px;border-bottom:1px solid var(--bg);font-variant-numeric:tabular-nums">${v}</td></tr>`
  ).join('')+'</table>';
}else{
  mp.innerHTML='<span style="color:var(--fg3);font-size:11px">No memory data</span>';
}

addEventListener('resize',resize);
resize();
</script>
</body>
</html>
